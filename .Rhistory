ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", aes(fill="steelblue"))
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue")
ggplot(newsmedia, aes(Month, Pageviews, ymax=1000)) + geom_bar(stat="identity", position="dodge", fill="steelblue")
ggplot(newsmedia, aes(Month, Pageviews, ymax=1200)) + geom_bar(stat="identity", position="dodge", fill="steelblue")
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + ylim(c(0, 1000))
newsmedia
str(newsmedia)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue")
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + ylim(c(0,1250))
?ylim
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month")
newsmedia$Month <- as.factor(newsmedia$Month, levels=newsmedia$Month)
newsmedia$Month <- factor(newsmedia$Month, levels=newsmedia$Month)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month")
newsmedia <- data.frame(Month=c("November", "December", "January", "February", "March"), Pageviews=c(6307, 7960, 6612, 5987, 8913))
newsmedia$Month <- factor(newsmedia$Month, levels=newsmedia$Month)
library(ggplot2)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month")
newsmedia <- data.frame(Month=c("November", "December", "January", "February", "March"), Pageviews=c(6307, 7960, 6612, 5987, 8913))
newsmedia$Month <- factor(newsmedia$Month, levels=newsmedia$Month)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month")
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0,1000))
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 1000))
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000))
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank())
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Prop), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
869+683+319+275+274
6307-2420
913+568
7961-(1053+913+568+555+476+467)
6162-(523+334+330+327+326)
5987-(666+511+348+299+285)
8913-(941+628+532+525+392)
rep(6, "November")
rep("November", 6)
nov <- data.frame(Story=c("College Celebrates Ring Delivery", "Concordia Theatre Presents Les Miserables", "Author Takes Winding Path to Success", "Finding the Global Perspective", "Hubbard Headlines Offutt Event", "Other"), Pageviews=c(869,683,319,275,274,3887), Month=rep("November", 6))
dec <- data.frame(Story=c("Celebrating a Concorida Christmas Tradition", "Christmas Concert Filled with Light", "Alumnus Research Becomes Personal", "They Came, They Saw, They Made History", "Concordia Great, Dr. Walther Prausnitz", "Other"), Pageviews=c(1053, 1481, 555, 476, 467, 3929), Month=rep("December", 6))
jan <- data.frame(Story=c("What's Complicated About Honoring King?", "Authors Announced for National Book Awards", "Short Documentary Gets International Recognition", "Grad Attends Top School for Public Health", "Play it Forward", "Other"), Pageviews=c(523,334,330,327,326,4332), Month=rep("January", 6))
feb <- data.frame(Story=c("The Singers Celebrate Clausen", "Concordia's Brainerd Concert is a Homecoming", "Kazoos at Concordia", "Formula for a Good Fit", "Wholly Concordia! Creating Connections", "Other"), Pageviews=c(666,511,348,299,285,3878), Month=rep("February", 6))
march <- data.frame(Story=c("Faculty Featured on TLC with Josh Groban", "Wholly Concordia! Better Business", "Spring Break 2015", "Getting Their Act Together", "Professor Featured on BBC","Other"), Pageviews=c(941,628,532,525,392,5895), Month=rep("March", 6))
months <- rbind(nov, dec, jan, feb, march)
months
ggplot(months, aes(Month, Pageviews)) + geom_bar(stat="identity", aes(fill=Story)) + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
nov <- data.frame(Story=c("College Celebrates Ring Delivery", "Concordia Theatre Presents Les Miserables", "Author Takes Winding Path to Success", "Finding the Global Perspective", "Hubbard Headlines Offutt Event", "Other"), Pageviews=c(869,683,319,275,274,3887), Month=rep("November", 6), Rank=c(1:6))
dec <- data.frame(Story=c("Celebrating a Concorida Christmas Tradition", "Christmas Concert Filled with Light", "Alumnus Research Becomes Personal", "They Came, They Saw, They Made History", "Concordia Great, Dr. Walther Prausnitz", "Other"), Pageviews=c(1053, 1481, 555, 476, 467, 3929), Month=rep("December", 6), Rank=c(1:6))
jan <- data.frame(Story=c("What's Complicated About Honoring King?", "Authors Announced for National Book Awards", "Short Documentary Gets International Recognition", "Grad Attends Top School for Public Health", "Play it Forward", "Other"), Pageviews=c(523,334,330,327,326,4332), Month=rep("January", 6), Rank=c(1:6))
feb <- data.frame(Story=c("The Singers Celebrate Clausen", "Concordia's Brainerd Concert is a Homecoming", "Kazoos at Concordia", "Formula for a Good Fit", "Wholly Concordia! Creating Connections", "Other"), Pageviews=c(666,511,348,299,285,3878), Month=rep("February", 6), Rank=c(1:6))
march <- data.frame(Story=c("Faculty Featured on TLC with Josh Groban", "Wholly Concordia! Better Business", "Spring Break 2015", "Getting Their Act Together", "Professor Featured on BBC","Other"), Pageviews=c(941,628,532,525,392,5895), Month=rep("March", 6), Rank=c(1:6))
months <- rbind(nov, dec, jan, feb, march)
ggplot(months, aes(Month, Pageviews)) + geom_bar(stat="identity", aes(fill=Rank)) + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
319+275+274+3887
3929+467+476+555
4332+326+327+330
3878+285+299+348
5895+392+525+532
# Top 2 Stories by Month
nov2 <- data.frame(Story=c("College Celebrates Ring Delivery", "Concordia Theatre Presents Les Miserables", "Other"), Pageviews=c(869,683,4755), Month=rep("November", 3), Rank=c(1:3))
dec2 <- data.frame(Story=c("Celebrating a Concorida Christmas Tradition", "Christmas Concert Filled with Light", "Other"), Pageviews=c(1053, 1481, 5427), Month=rep("December", 3), Rank=c(1:3))
jan2 <- data.frame(Story=c("What's Complicated About Honoring King?", "Authors Announced for National Book Awards",  "Other"), Pageviews=c(523,334,5315), Month=rep("January", 3), Rank=c(1:3))
feb2 <- data.frame(Story=c("The Singers Celebrate Clausen", "Concordia's Brainerd Concert is a Homecoming", "Other"), Pageviews=c(666,511,4810), Month=rep("February", 3), Rank=c(1:3))
march2 <- data.frame(Story=c("Faculty Featured on TLC with Josh Groban", "Wholly Concordia! Better Business", "Other"), Pageviews=c(941,628,7344), Month=rep("March", 3), Rank=c(1:3))
months2 <- rbind(nov2, dec2, jan2, feb2, march2)
ggplot(months2, aes(Month, Pageviews)) + geom_bar(stat="identity", aes(fill=Rank)) + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
# Top 2 Stories by Month
nov2 <- data.frame(Story=c("College Celebrates Ring Delivery", "Concordia Theatre Presents Les Miserables", "Other"), Pageviews=c(869,683,4755), Month=rep("November", 3), Rank=c(1:3))
dec2 <- data.frame(Story=c("Christmas Concert Filled with Light","Celebrating a Concorida Christmas Tradition",  "Other"), Pageviews=c(1481, 1053, 5427), Month=rep("December", 3), Rank=c(1:3))
jan2 <- data.frame(Story=c("What's Complicated About Honoring King?", "Authors Announced for National Book Awards",  "Other"), Pageviews=c(523,334,5315), Month=rep("January", 3), Rank=c(1:3))
feb2 <- data.frame(Story=c("The Singers Celebrate Clausen", "Concordia's Brainerd Concert is a Homecoming", "Other"), Pageviews=c(666,511,4810), Month=rep("February", 3), Rank=c(1:3))
march2 <- data.frame(Story=c("Faculty Featured on TLC with Josh Groban", "Wholly Concordia! Better Business", "Other"), Pageviews=c(941,628,7344), Month=rep("March", 3), Rank=c(1:3))
months2 <- rbind(nov2, dec2, jan2, feb2, march2)
ggplot(months2, aes(Month, Pageviews)) + geom_bar(stat="identity", aes(fill=Rank)) + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
+ geom_text(aes(label=Prop), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(months2, aes(Month, Pageviews)) + geom_bar(stat="identity", aes(fill=Rank)) + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank())
newsmedia <- data.frame(Month=c("November", "December", "January", "February", "March"), Pageviews=c(6307, 7960, 6162, 5987, 8913))
newsmedia$Month <- factor(newsmedia$Month, levels=newsmedia$Month)
#library(ggplot2)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Pageviews to all News and Media pages by month") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(newsmedia, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="News & Media Pageviews") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
appurls <- data.frame(Month=c("November", "December", "January", "February", "March"), Pageviews=c(497, 592,497,503,367))
appurls$Month <- factor(appurls$Month, levels=appurls$Month)
#library(ggplot2)
ggplot(appurls, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="News & Media Pageviews") + ylim(c(0, 10000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(appurls, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="News & Media Pageviews") + ylim(c(0, 750)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(appurls, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Unique Application URL Pageviews") + ylim(c(0, 750)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
source('~/.active-rstudio-document')
homepage <- data.frame(Month=c("November", "December", "January", "February", "March", "April"), Pageviews=c(55506, 42495,53938,51982,52050,50616))
homepage$Month <- factor(homepage$Month, levels=homepage$Month)
#library(ggplot2)
ggplot(homepage, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Homepage Pageviews") + ylim(c(0, 750)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
library(ggplot2)
ggplot(homepage, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Homepage Pageviews") + ylim(c(0, 750)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(homepage, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Homepage Pageviews") + ylim(c(0, 75000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
ggplot(homepage, aes(Month, Pageviews)) + geom_bar(stat="identity", position="dodge", fill="steelblue") + labs(title="Homepage Pageviews") + ylim(c(0, 65000)) + theme(panel.background = element_blank()) + geom_text(aes(label=Pageviews), size=4, position=position_dodge(width=1), vjust=-.5)
getwd()
library("ggplot2")
rates <- data.frame(Percent=c(.6176,.9396,.3634,.5331,.2697,.1686,.1211,.0889), Rate=c(rep("open rate",4), rep("click to open rate",4)), Group=c(rep(c("deposit cobberlife", "deposit overall", "admit cobberlife", "admit overall"), 4)))
View(rates)
ggplot(rates, aes(Group, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Rate))
rates <- data.frame(Percent=c(.6176,.9396,.3634,.5331,.2697,.1686,.1211,.0889), Rate=c(rep("open rate",4), rep("click to open rate",4)), Group=c(rep(c("deposit", "deposit", "admit", "admit"), 4)), Send=c(rep(c("cobberlife", "overall"), 8))
View(rates)
rates <- data.frame(Percent=c(.6176,.9396,.3634,.5331,.2697,.1686,.1211,.0889), Rate=c(rep("open rate",4), rep("click to open rate",4)), Group=c(rep(c("deposit", "deposit", "admit", "admit"), 4)), Send=c(rep(c("cobberlife", "overall"), 8)))
View(rates)
ggplot(rates, aes(Group, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Rate))
rates$Combo <- paste(rates$Rate, rates$Send)
ggplot(rates, aes(Group, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Combo))
ggplot(rates, aes(Group, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Combo)) + scale_fill_brewer(palette="Paired")
rates <- data.frame(Percent=c(.6176,.9396,.3634,.5331,.2697,.1686,.1211,.0889), Rate=c(rep("open rate",4), rep("click to open rate",4)), Group=c(rep(c("deposit", "deposit", "admit", "admit"), 4)), Send=c(rep(c("cobberlife", "overall"), 8)))
rates$Combo <- paste(rates$Rate, rates$Group)
ggplot(rates, aes(Group, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Combo)) + scale_fill_brewer(palette="Paired")
View(rates)
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Group)) + scale_fill_brewer(palette="Paired")
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired")
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired") + theme(panel.background = element_blank()) + labs("CobberLife vs. Overall Rates", y="Percent", x="")
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired") + theme(panel.background = element_blank(), axis.text.x = element_text(angle = 45, hjust = 1)) + labs("CobberLife vs. Overall Rates", y="Percent", x="")
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired") + theme(panel.background = element_blank(), axis.text.x = element_text(angle = 15, hjust = 1)) + labs("CobberLife vs. Overall Rates", y="Percent", x="")
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired") + theme(panel.background = element_blank(), axis.text.x = element_text(angle = 15, hjust = 1)) + labs(title="CobberLife vs. Overall Rates", y="Percent", x="")
getwd()
ggplot(rates, aes(Combo, Percent)) + geom_bar(stat="identity", position="dodge", aes(fill=Send)) + scale_fill_brewer(palette="Paired") + theme(panel.background = element_blank(), axis.text.x = element_text(angle = 15, hjust = 1)) + labs(title="CobberLife vs. Overall Rates", y="Percent", x="") + geom_text(aes(label=Percent)
)
getwd()
setwd()~
)
setwd(~/)
setwd(~)
setwd("~")
getwd()
news <- read.table("/Users/kwalker/git_projects/DS_Capstone/data/US_en.news.sample.txt", stringsAsFactors=FALSE)
news <- read.table("/Users/kwalker/git_projects/DS_Capstone/data/en_US.news.sample.txt", stringsAsFactors=FALSE)
twitter <- read.table("/Users/kwalker/git_projects/DS_Capstone/data/en_US.twitter.sample.txt", stringsAsFactors=FALSE)
blog <- read.table("/Users/kwalker/git_projects/DS_Capstone/data/en_US.blog.sample.txt", stringsAsFactors=FALSE)
install.packages("tm")
install.packages("RWeka")
library("knitr")
library("tm")
library("RWeka")
hist(nchar(news))
unique(blog[1:100],)
unique(blog[1:10,])
unique(twitter[1:10,])
strsplit(twitter[1:10,], " ")
test <- strsplit(twitter[1:5,], " ")
test
corpusT = Corpus(VectorSource(twitter[1:10,]))
corpusT
corpusT <- tm_map(corpusT, tolower)
corpusT <- tm_map(corpusT, PlainTextDocument)
corpusT <- tm_map(corpusT, removePunctuation)
corpusT
summary(corpusT)
corpusT <- tm_map(corpusT, removeWords, stopwords("english"))
corpusT <- tm_map(corpusT, stemDocument)
corpusT = Corpus(VectorSource(twitter[1:10,]))
corpusT <- tm_map(corpusT, tolower)
corpusT <- tm_map(corpusT, PlainTextDocument)
corpusT <- tm_map(corpusT, removePunctuation)
corpusT <- tm_map(corpusT, stemDocument)
?tm_map
test <- twitter[1:10,]
test
test <- paste(test, collapse=" ")
test
test <- twitter[1:10,]
nchar(test)
test <- paste(test, collapse=" ")
nchar(test)
test <- strsplit(test, "?|!|.")
rest
test
test <- twitter[1:10,]
test <- paste(test, collapse=" ")
test <- strsplit(test, "\\?|\\!|\\.")
test
test <- strsplit(test, "\\? |\\! |\\. ")
test <- twitter[1:10,]
test <- paste(test, collapse=" ")
test <- strsplit(test, "\\? |\\! |\\. ")
test
test <- twitter[1:10,]
test <- paste(test, collapse=" ")
test <- strsplit(test, "\\? |\\?? |\\! |\\!! |\\. ")
test
test <- twitter[1:10,]
test <- paste(test, collapse=" ")
test <- strsplit(test, "\\? |\\! |\\. ")
test
test <- twitter[1:10,]
test
test <- paste(test, collapse=" ")
test
test <- strsplit(test, "\\?+ |\\!+ |\\.+ ")
test
test <- twitter[1:10,]
test <- strsplit(test, "\\?+ |\\!+ |\\.+ ")
test
test <- paste(test, collapse=" ")
test
test <- twitter[1:10,]
test <- paste(test, collapse=" ")
test
test <- strsplit(test, "\\?+ |\\!+ |\\.+ ")
test
source('~/.active-rstudio-document', echo=TRUE)
setwd("/Users/kwalker/git_projects/DS_Capstone/")
corpus <- Corpus(DirSource("testdata"), readerControl=list(language="en"))
news[1,]
twitter[1,]
twitter[15,]
twitter[150,]
twitter[100,]
blog[1,]
blog[100,]
blog[1000,]
blog[10,]
news[100,]
paste("News", news[100,])
paste("NEWS:  ", news[100,])
paste("BLOG:  ", blog[100,])
paste("BLOG:  ", blog[100,])
setwd("/Users/kwalker/git_projects/DS_Capstone/")
hist(log10(freqTable$freq))
source('~/.active-rstudio-document', echo=TRUE)
hist(log10(freqTable$freq))
qplot(freq, data=freqTable, geom="histogram")
qplot(log10(freq), data=freqTable, geom="histogram")
qplot(log10(freq), data=freqTable, geom="histogram")
ggplot(freqTable, aes(x=log10(freq))) + geom_histogram()
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram() + labs(title="Log 10 Frequency of Bigrams") + theme(panel.background=element_blank())
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram() + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
hist(log10(freqTable2$freq))
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram() + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram(binwidth=.1) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
hist(log10(freqTable2$freq))
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram(binwidth=.1) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable2, aes(x=log10(freq))) + geom_histogram(binwidth=.01) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable3, aes(x=log10(freq))) + geom_histogram(binwidth=.1) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable3, aes(x=freq)) + geom_histogram(binwidth=.1) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable3, aes(x=freq)) + geom_histogram(binwidth=.5) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
hist(log10(freqTable2$freq))
ggplot(freqTable3, aes(y=freq)) + geom_histogram(binwidth=.5) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable3, aes(x=freq)) + geom_histogram(binwidth=.5) + labs(title="Log 10 Frequency of Bi-grams") + theme(panel.background=element_blank())
ggplot(freqTable, aes(x=log10(freq))) + geom_histogram() + labs(title="Log 10 Frequency of Tokens") + theme(panel.background=element_blank())
ggplot(freqTable, aes(y=log10(freq), x=..count..)) + geom_histogram() + labs(title="Log 10 Frequency of Tokens") + theme(panel.background=element_blank())
ggplot(freqTable, aes( x=..count.., y=log10(freq))) + geom_histogram() + labs(title="Log 10 Frequency of Tokens") + theme(panel.background=element_blank())
hist(log10(freqTable2$freq), main="Log10 Bigram Frequency")
gramTable <- cbind(freqTable2[1:10, c(3,1,2) ],freqTable3[1:10, 1:2 ],)
gramTable <- cbind(freqTable2[1:10, c(3,1,2) ],freqTable3[1:10, 1:2 ])
gramTbale
gramTable
colnames(gramTable) <- c("rank", "bi-gram", "f" "tri-gram", "f")
kable(gramTable, row.names=FALSE)
colnames(gramTable) <- c("rank", "bi-gram", "f", "tri-gram", "f")
kable(gramTable, row.names=FALSE)
hist(freqTable2$freq, main="Log10 Bi-gram Frequency")
hist(freqTable3$freq, main="Log10 Tri-gram Frequency")
freqTerms <- findFreqTerms(uniCorpus, lowfreq = 5)
freqTable <- rowSums(as.matrix(uniCorpus[freqTerms,]))
freqTable <- data.frame(word=names(freqTable), freq=freqTable)
freqTable <- freqTable[order(-freqTable$freq), ]
freqTable$rank <- 1:length(freqTable[,1])
freqTerms2 <- findFreqTerms(biCorpus, lowfreq = 5)
freqTable2 <- rowSums(as.matrix(biCorpus[freqTerms2,]))
freqTable2 <- data.frame(word=names(freqTable2), freq=freqTable2)
freqTable2 <- freqTable2[order(-freqTable2$freq), ]
freqTable2$rank <- 1:length(freqTable2[,1])
freqTerms3 <- findFreqTerms(triCorpus, lowfreq = 5)
freqTable3 <- rowSums(as.matrix(triCorpus[freqTerms3,]))
freqTable3 <- data.frame(word=names(freqTable3), freq=freqTable3)
freqTable3 <- freqTable3[order(-freqTable3$freq), ]
freqTable3$rank <- 1:length(freqTable3[,1])
gramTable <- cbind(freqTable[1:10, c(3,1,2) ], freqTable2[1:10, 1:2],freqTable3[1:10, 1:2 ])
colnames(gramTable) <- c("rank", "uni-gram", "f", "bi-gram", "f", "tri-gram", "f")
kable(gramTable, row.names=FALSE)
hist(log10(freqTable$freq),  main="Log10 Uni-gram Frequency")
hist(log10(freqTable2$freq), main="Log10 Bi-gram Frequency")
hist(log10(freqTable3$freq), main="Log10 Tri-gram Frequency")
print "News"
print("News")
plot(data=freqTable, x=log10(freq), y=log10(rank))
plot(data=freqTable, x=log10(freqTable$freq), y=log10(freqTable$rank))
plot(x=log10(freqTable$freq), y=log10(freqTable$rank), main="Zipf's Law")
plot(x=log10(freqTable$freq), y=log10(freqTable$rank), type="l", main="Zipf's Law")
setwd("/Users/kwalker/git_projects/DS_Capstone/")
corpus <- Corpus(DirSource("data"), readerControl=list(language="en"))
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, content_transformer(tolower))
options(mc.cores=1)
unigrams <- function(x) NGramTokenizer(x, Weka_control(min=1, max=1))
bigrams <- function(x) NGramTokenizer(x, Weka_control(min=2, max=2))
trigrams <- function(x) NGramTokenizer(x, Weka_control(min=3, max=3))
uniCorpus <- TermDocumentMatrix(corpus, control=list(tokenize = unigrams))
biCorpus <- TermDocumentMatrix(corpus, control=list(tokenize = bigrams))
triCorpus <- TermDocumentMatrix(corpus, control=list(tokenize = trigrams))
freqTerms <- findFreqTerms(uniCorpus, lowfreq = 5)
freqTable <- rowSums(as.matrix(uniCorpus[freqTerms,]))
freqTable <- data.frame(word=names(freqTable), freq=freqTable)
freqTable <- freqTable[order(-freqTable$freq), ]
freqTable$rank <- 1:length(freqTable[,1])
freqTerms2 <- findFreqTerms(biCorpus, lowfreq = 5)
freqTable2 <- rowSums(as.matrix(biCorpus[freqTerms2,]))
freqTable2 <- data.frame(word=names(freqTable2), freq=freqTable2)
freqTable2 <- freqTable2[order(-freqTable2$freq), ]
freqTable2$rank <- 1:length(freqTable2[,1])
freqTerms3 <- findFreqTerms(triCorpus, lowfreq = 5)
freqTable3 <- rowSums(as.matrix(triCorpus[freqTerms3,]))
freqTable3 <- data.frame(word=names(freqTable3), freq=freqTable3)
freqTable3 <- freqTable3[order(-freqTable3$freq), ]
freqTable3$rank <- 1:length(freqTable3[,1])
gramTable <- cbind(freqTable[1:10, c(3,1,2) ], freqTable2[1:10, 1:2],freqTable3[1:10, 1:2 ])
colnames(gramTable) <- c("rank", "uni-gram", "f", "bi-gram", "f", "tri-gram", "f")
kable(gramTable, row.names=FALSE)
hist(log10(freqTable$freq),  main="Log10 Uni-gram Frequency")
hist(log10(freqTable2$freq), main="Log10 Bi-gram Frequency")
hist(log10(freqTable3$freq), main="Log10 Tri-gram Frequency")
plot(x=log10(freqTable$freq), y=log10(freqTable$rank), type="l", main="Zipf's Law")
allWordInstances <- sum(freqTable$freq)
freqTable$Sum <- cumsum(freqTable$freq)
fifty <- subset(freqTable, freqTable$Sum >  allWordInstances*0.5)
ninety <- subset(freqTable, freqTable$Sum >  allWordInstances*0.9)
fifty[1,3]
ninety[1,3]
ninetynine <- subset(freqTable, freqTable$Sum >  allWordInstances*0.99)
head(ninetynine)
hist(log10(freqTable$freq),  main="Log10 Uni-gram Frequency")
hist(log10(freqTable2$freq), main="Log10 Bi-gram Frequency")
hist(log10(freqTable3$freq), main="Log10 Tri-gram Frequency")
hist(freqTable$freq,  main="Log10 Uni-gram Frequency")
hist(freqTable2$freq, main="Log10 Bi-gram Frequency")
source('~/.active-rstudio-document', echo=TRUE)
head(ninety)
inspect(corpus[1:10,])
inspect(uniCorpus[1:10,])
Dictionary(uniCorpus)
library("tm")
Dictionary(uniCorpus)
?Dictionary
?dictionary
Terms(uniCorpus)
freqTable2$Sum <- cumsum(freqTable2$freq)
bi90 <- subset(freqTable2, freqTable2$Sum > sum(freqTable2$freq)*0.9)
uni50 <- subset(freqTable, freqTable$Sum >  allWordInstances*0.5) #266
uni90 <- subset(freqTable, freqTable$Sum >  allWordInstances*0.9) #6676
uni50[1,3]
uni90[1,]
freqTable3$Sum <- cumsum(freqTable3$freq)
tri90 <- subset(freqTable3, freqTable3$Sum > sum(freqTable3$freq)*0.9)
tri90[1,]
biCutoff <- bi90[1,3]
uniCutoff <- uni90[1,3]
triCutoff <- tri90[1,3]
biCorpus
inspect(biCorpus[1:10])
inspect(biCorpus[1:10,])
uniDictionary <- subset(freqTable, freqTable$Rank > uniCutoff)
head(freqTable)
freqTerms <- findFreqTerms(uniCorpus, lowfreq = 5)
freqTable <- rowSums(as.matrix(uniCorpus[freqTerms,]))
freqTable <- data.frame(word=names(freqTable), freq=freqTable)
freqTable <- freqTable[order(-freqTable$freq), ]
freqTable$rank <- 1:length(freqTable[,1])
freqTable
freqTable$Sum <- cumsum(freqTable$freq)
uni50 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.5) #266
uni90 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.9) #6676
uniCutoff <- uni90[1,3]
uniDictionary <- subset(freqTable, freqTable$Rank > uniCutoff)
uniCutoff
uni90
uniDictionary <- subset(freqTable, freqTable$Rank < uniCutoff)
freqTable$Sum <- cumsum(freqTable$freq)
uni50 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.5) #266
uni90 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.9) #6676
uniCutoff <- uni90[1,3]
uniDictionary <- subset(freqTable, freqTable$Rank < uniCutoff)
uniDictionary <- subset(freqTable, freqTable$rank < uniCutoff)
uniDictionary
biDictionary <- subset(freqTable2, freqTable2$rank < biCutoff)
triDictionary <- subset(freqTable3, freqTable3$rank < triCutoff)
triDictionary
uniDictionary <- freqTable[freqTable$rank < uniCutoff, 1]
uniDictionary
biDictionary <- freqTable2[freqTable2$rank < biCutoff, 1]
triDictionary <- freqTable3[freqTable3$rank < triCutoff, 1]
triDictionary
head(corpus)
inspect(corpus)
n <- content_transformer(function(x, pattern)) regmatches(x, gregexpr(pattern, x, perl=TRUE, ignore.case=TRUE))
n <- content_transformer(function(x, pattern) regmatches(x, gregexpr(pattern, x, perl=TRUE, ignore.case=TRUE)))
tm_map(uniCorpus, n, uniDictionary)
tm_map(corpus, n, uniDictionary)
uniDictionary
uniCorpus <- TermDocumentMatrix(corpus, control=list(tokenize = unigrams))
freqTerms <- findFreqTerms(uniCorpus, lowfreq = 5)
freqTable <- rowSums(as.matrix(uniCorpus[freqTerms,]))
freqTable <- data.frame(word=names(freqTable), freq=freqTable)
freqTable <- freqTable[order(-freqTable$freq), ]
freqTable$rank <- 1:length(freqTable[,1])
View(freqTable)
freqTable$Sum <- cumsum(freqTable$freq)
uni50 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.5) #266
uni90 <- subset(freqTable, freqTable$Sum >  sum(freqTable$freq)*0.9) #6676
uniCutoff <- uni90[1,3]
corpus <- Corpus(DirSource("testdata"), readerControl=list(language="en"))
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, content_transformer(tolower))
n <- content_transformer(function(x, pattern) regmatches(x, gregexpr(pattern, x, perl=TRUE, ignore.case=TRUE)))
tm_map(corpus, n, uniDictionary)
?gregexpr
n <- content_transformer(function(x, pattern) regmatches(x, gregexpr(pattern, x)))
tm_map(corpus, n, uniDictionary)
?regmatches
?tm_map
n <- content_transformer(function(x, pattern) regmatches(x, gregexpr(pattern, x)))
tm_map(corpus, n, uniDictionary)
unlist(uniDictionary)
tm_map(corpus, n, unlist(uniDictionary))
unlist(uniDictionary)
tm_map(corpus, n, as.character(unlist(uniDictionary)))
as.character(unlist(uniDictionary))
tm_map(corpus, n, uniDictionary)
uniDictionary <- as.character(unlist(uniDictionary))
tm_map(corpus, n, uniDictionary)
?unlist
c(uniDictionary)
list(uniDictionary)
tm_map(corpus, n, list(uniDictionary))
corpus2 <- tm_map(corpus, n, list(uniDictionary))
inspect(corpus2[1:10,])
inspect(corpus2[1:10])
corpus2 <- removeSparseTerms(corpus, 0.1)
corpus2 <- removeSparseTerms(uniCorpus, 0.1)
dim(corpus2)
dim(uniCorpus)
summary(uniCorpus)
print(uniCorpus)
print(corpus2)
?removeSparseTerms
data(crude)
tdm <- TermDocumentMatrix(crude)
print(tdm)
inspect(tdm[1:10,])
removeSparseTerms(tdm, 0.2)
inspect(tdm[1:10,])
tdm2 <- removeSparseTerms(tdm, 0.2)
inspect(tdm2[1:10,])
inspect(tdm2[1:10])
print(tdm2)
dim(tdm2)
dim(tdm)
corpus2 <- removeSparseTerms(uniCorpus, 0.5)
dim(uniCorpus)
dim(corpus2)
196/1380
corpus2 <- removeSparseTerms(uniCorpus, 0.75)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.3)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.1)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.4)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.8)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.1)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.15)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.87)
dim(corpus2)
1380*.9
inspect(uniCorpus[1:10,])
corpus2 <- removeSparseTerms(uniCorpus, 0.1)
inspect(corpus2[1:10,])
inspect(corpus2)
dim(corpus2)
corpus2 <- removeSparseTerms(uniCorpus, 0.5)
dim(corpus2)
inspect(corpus2)
summary(corpus2, uniCorpus)
summary(c(corpus2, uniCorpus))
?tm_combine
head(corpus2[[1]]$content)
head(corpus2$content)
inspect(corpus2[1:10])
inspect(corpus2[1:10,])
inspect(corpus2$content)
inspect(corpus2[[1]]$content)
corpus2[[1]]$content
x <- tm_map(corpus2, PlainTextDocument)
x <- tm_map(uniCorpus, PlainTextDocument)
x <- tm_map(corpus, PlainTextDocument)
inspect(x)
inspect(x[1:10,])
inspect(x[1:10])
inspect(x[1:2])
head(x)
summary(x)
print(x)
m <- as.matrix(uniCorpus)
head(m)
u <- as.matrix(uniCorpus)
b <- as.matrix(biCorpus)
t <- as.matrix(triCorpus)
x <- rbind(u,b,t)
str(x)
dim(x)
x[1370:1450,]
source('~/.active-rstudio-document', echo=TRUE)
